\clearpage
\section{Development plan}\label{sec:development_plan}

This section describes the development plan for the METIS data reduction software to comply with the the specifications and standards of the ESO data reduction libraries given in the ESO dataflow deliverables standards document (\cite{1618}). The test and validation procedures for the pipeline software are described in \cite{DRLVT}. 
Test data are are required for the pipeline software development, including the development of pipeline recipes, workflows and for pipeline testing and validation. The sources of test data are:
\begin{itemize}
    \item Simulated data using the ScopeSim software tool
    \item Archive data from similar instruments (e.g. VISIR, SPHERE, ERIS)
    \item Laboratory data obtained during the AIT phase
\end{itemize}
Further details are given in \cite{DRLVT}.

The time schedule is subject to regular updates and review in close cooperation with

\begin{itemize}
    \item \ac{AIT team: coordination of the pipeline implementation schedule
    \item ICS team: coordination with ICS implementation schedule to test the data flow between ICS and pipeline and check consistency of FITS keywords
    \item Detector group: coordination when detector characteristics become available
    \item Calibration Scientist: check consistency of pipeline calibration data products, coordinate the population of the calibration database
    \item Instrument Scientist: check consistency of FITS keywords, QC parameters, pipeline data products and coordination of the end-to-end tests of the pipeline
    \item ESO: check consistency of FITS keywords, QC parameters, coordinate required input to software recipe development (detector persistence, ...) and coordinate the pipeline implementation schedule
\end{itemize}

Table \ref{tab:development_schedule} provides an overview of the milestone schedule for the METIS pipeline development.

\begin{table}
    \caption[Development schedule]{Milestones of the METIS pipeline software development schedule starting at FDR}
  \label{tab:development_schedule}
  \centering\scriptsize
  \begin{tabularx}{\textwidth}{llll}
    \hline
    Milestone & Name & Time from FDR & Start date \\
    \hline\hline
    PIP FDR          & Pipeline final design review & T$_ {FDR}$ + 0 months & Nov 2023 \\
    Post-FDR 1       & Simulated raw data, processed data &  T$_ {FDR}$ + 6 months & May 2024 \\
    Post-FDR 2       & DRS chain skeleton               &  T$_{FDR}$ + 12 months & Nov 2024 \\
    PAE              & Preliminary Acceptance in Europe &  T$_{FDR}$ + XX months &  \\
    COM1             & First instrument commissioning &  & \\
    COM2             & Second instrument commissioning &  & \\
    CFP              & Call for proposal (Phase I) &  & \\
    PAC              & Preliminary Acceptance in Chile &  & \\
    PH2              & Phase 2 observation preparation &  & \\
    SO1              & Science operations (1st observing period) &  & \\
    SO2              & Science operations (2nd observing period) &  & \\
    GTO              & Guaranteed time observations &  & \\
    FAO              & Final acceptance at the observatory & & \\
    \hline
  \end{tabularx}
\end{table}

\subsection{FDR to PAE development plan}
\label{ssec:fdr2pae}

It is planned to monitor the status of pipeline software implementation in regular progress meetings, where, if necessary, specific action items can be defined. Starting after FDR the implementation of the development schedule (table \ref{tab:development_schedule}) will be carried out in the subsequent steps:

\begin{enumerate}
    \item The baseline for the pipeline development environment regarding
    \item Review and adapt the schedule for the pipeline software development after successful PIP FDR in compliance with the METIS DRL Validation and Test Plan (\cite{DRLVT}). A priority list for the implementation of the PIP capabilities will be agreed with the AIT team. It will categorize high, medium and low priorities of pipeline modules for subsystem and system level AIT. The priority list will be reviewed in regular intervals in progress of AIT.
   
    High priority tasks of the pipeline development (at start of Phase D): 
    \begin{itemize}
        \item The interface with ICS has to be set up in order to create proper FITS files 
        \item Recipes needed for the detector characterisation
    \end{itemize} 
    These modules should be ready at the start of system AIT phase CD to support the integration of the detectors.
    
    Medium priority tasks to support the integration of LMS and IMG:
    \begin{itemize}
        \item Processing of LMS and IMG data which includes in particular background subtraction, wavelength calibration recipes for the spectroscopic modes and LMS cube reconstruction
        \item Additional recipes needed: Distortion map, RSRF calibration, contrast curve
        \item Support of stray light analysis tools (TBD)
    \end{itemize}
    Following the outline of the system AIT plan, LMS-related modules should be first available in the first months of the system AIT phase CD, followed later by IMG-related modules.

    Low priority tasks:
    \begin{itemize}
        \item Processing of HCI data (pupil imaging)
        \item Slit-loss calibration
        \item Fringing calibration recipe 
        \item Characterisation of various background subtraction methods
        \item Quality control parameters
    \end{itemize}
    
    Furtheron, a detailed schedule will be set up with ESO regarding updated versions of pipeline package.
    \item Simulated and processed data at T$_{FDR}$ + 6 months: the package includes raw data, intermediate data and science data products for each instrument mode. The simulated data will be used to test the data flow system.
    \item Delivery of the DRS chain skeleton
    \item Updated versions of the pipeline package in previously agreed intervals consisting of:
    \begin{itemize}
        \item Updated version of the DRL document
        \item Reports on tests performed at the level of pipeline recipes
        \item Test and calibration data
        \item Updated version of the pipeline/QC user manual
        \item Report describing the status of the DRL implementation
        \item List of action items
    \end{itemize}
\end{enumerate}

The pipeline skeleton consists of the recipes \emph{shells}, i.e.~the executable
code that takes the expected inputs and parameters and produces output files,
albeit without actually performing any reductions; pixel values of input and
outputs are just dummy values at this stage. The purpose of chain skeleton is to
demonstrate the data flow but is otherwise empty from the algorithmic point of
view. Depending on the release status of the \ac{EDPS}, the chain can be
assembled with it. Otherwise a simple software integration environment of the
METIS data flow team will be used for this purpose. 


\subsection{METIS Preliminary Acceptance in Europe (PAE)}
\label{ssec:pae_europe}

PAE completes the METIS AIT phase. At this stage, the pipeline software has reached a maturity level where all components are fully developed and integrated. It is expected that at this point also lab data from the AIT phase will be available for test and validation purposes in addition to the simulated test data package. The pipeline PAE will consist of 3 phases: a test readiness review, an end-to-end simulation of the data flow and the PAE review phase.

\subsubsection{Test Readiness Review}
\label{sssec:trr}

The pipeline package will be carefully reviewed to check its compliance to \cite{1618} approximately 3 months before the PAE review. The review requires:
\begin{itemize}
    \item The METIS instrument has been fully assembled, aligned and all tests at subsystem level have been performed
    \item Both simulated data and lab data obtained during the AIT phase are available for verification purposes to cover all relevant instrument modes
    \item Full unit tests have been implemented at the algorithmic level to check requirement compliance
    \item Full error propagation has been implemented to check requirement compliance
    \item A science use case has been assigned to each observing mode
\end{itemize}
The review will be carried out in close cooperation with ESO pipeline experts to prepare the integration of the pipeline at the observatory.

\subsubsection{End-to-End tests of the data flow system}
\label{sssec:e2e}

The scope of the data flow end-to-end simulation is to validate the full process of pipeline data management and processing. The process will consist of
\begin{itemize}
    \item One science case per observing mode will be used as demonstrator
    \item Raw data will be processed in final data products
    \item Check that that the input raw data are correctly organized
    \item Check that recipes are executed in the correct order in the data flow
    \item Check that intermediate data products are passed correctly in the data flow
    \item Final consistency checks on the data flow system (FITS keywords, QC parameters, ...)
    \item Final check on relevant documents (user manuals)
\end{itemize}
Further details are specified in \cite{DRLVT}.

\subsubsection{PAE review phase}
\label{sssec:paw_review}

The PAE review phase will consist of the formal approval of the PAE deliverables described in \cite{1618}. The reports of the Test Readiness Review and the data flow end-to-end simulation will be attached to them. 

\subsection{METIS instrument commissioning}
\label{ssec:com}

It is planned that the commissioning period will be divided in three sections

\subsubsection{Commissioning period 1 (COM1)}
\label{ssec:com1}

The aim of the COM1 period is to test the interface of METIS with the ELT and the characterization of the instrument performance including the data reduction pipeline software. COM1 will consist of several observing runs to perform all necessary tests, observations and calibrations. This includes also the preparation of the data flow science operation system. The prerequisites for the data reduction pipeline are
\begin{itemize}
    \item METIS has been fully integrated at the ELT
    \item METIS passed the instrument functional hardware and software tests
    \item The data reduction pipeline  has been fully integrated and validated
\end{itemize}
The COM1 deliverables are specified in \cite{1618}.

\subsubsection{Performance Assessment Period (PAP)}
\label{ssec:pap}

The test results of COM1 will be analyzed and the instrument commissioning data will be released.

\subsubsection{Commissioning period 2 (COM2)}
\label{ssec:com2}

The scope of COM2 is to establish the science operation readiness of METIS integrated at the ELT. This includes in particular the full data flow system and data reduction pipeline functionality with a first version of a completely populated calibration data base. The COM2 deliverables are specified in \cite{1618}.

\subsection{METIS Preliminary Acceptance in Chile}
\label{ssec:pae_chile}

At the time of PAC the final version of the Data Reduction Library package will be available. Data from the ESO Archive will be processed with the data reduction pipeline  which have to comply with ESO standards on data formats and data products. The PAC deliverables are specified in \cite{1618}. Upon successful completion of PAC, the two-year guarantee period will start as defined in the Statement of Work.

\subsection{METIS science operations}
\label{ssec:sciops}

MEITS science operations will consist of two observation periods, SO1 and SO2 respectively. SO1 will start upon successful completion of PAC. The data reduction pipeline will support the scientific data analysis with the METIS pipeline software team providing support to ESO. The SO1 deliverables are specified in \cite{1618}.

SO2 will be used to further refine the data reduction pipeline package based upon feedback from SO1. This should be the final consolidation of the pipelines software and all relevant documentation and user manuals. The SO2 deliverables are specified in \cite{1618}.
