\subsection{IFU observing mode}\label{sec:drl_functions_ifu}

\subsubsection{IFU wavelength calibration} \label{drl:ifu_wavecal}
    \begin{recipedef}
        Name: & \DRL{ifu_wavecal} \\
        Purpose: & Find the pixel-to-wavelength conversion for IFU exposures \\
        Used in recipes: & \REC{metis_ifu_reduce}\\
        %Working remarks: & None \\
        %Function Parameters: & None \\
        Input: & \texttt{const hdrl\_image * input} \\
        %Other inputs: &  \\
        %QC outputs: & None\\
        %Output FITS files: & None \\
        Outputs: & \PROD{IFU_WAVECAL}\\
                 & \texttt{cpl\_error\_code} \\
        General description: &  \\
        Mathematical description: & See section \ref{sssec:ifu_wavecal} \\
        Quality assessment: & Through QC parameters \\
        Error conditions: & See~\cite{DRLVT}. \\
        Unit tests: & See~\cite{DRLVT}. \\
    \end{recipedef}

\subsubsection{IFU output grid determination}\label{drl:ifu_grid_output}
    \begin{recipedef}
        Name: & \DRL{ifu_grid_output} \\
        Purpose: & Determine the exact positions of exposures before co-adding \\
        Used in recipes: & \REC{metis_ifu_postprocess}\\
        %Working remarks: & None \\
        %Function Parameters: & None \\
        Input: & $6\times$ \texttt{const hdrl\_image * input} \\
        Other inputs: & precise position and orientation of individual exposures \\
        %QC outputs: & None\\
        %Output FITS files: & None \\
        Outputs:    & \PROD{IFU_SCI_COMBINED} \\
                    & \texttt{cpl\_error\_code} \\
        General description: & Determine the position of the output grids for dithering of multiple exposures \\
        Mathematical description: & See section \ref{sssec:ifu_sci_postprocess} \\
        Quality assessment: & Through QC parameters \\
        Error conditions: & See~\cite{DRLVT}. \\
        Unit tests: & See~\cite{DRLVT}. \\
    \end{recipedef}

\subsubsection{IFU multi-exposure resampling}\label{drl:ifu_resampling}
    \begin{recipedef}
        Name: & \DRL{ifu_resampling} \\
        Purpose: & Obtain maximal useful resolution from a set of subpixel-shifted exposures \\
        Used in recipes: & \REC{metis_ifu_postprocess}\\
        %Working remarks: & None \\
        %Function Parameters: & None \\
        Input: & $6\times$ \texttt{const hdrl\_image * input} \\
        Other inputs: & precise position and orientation of individual exposures \\
        %QC outputs: & None\\
        %Output FITS files: & None \\
        Outputs:    & \PROD{IFU_SCI_COMBINED} \\
                    & \texttt{cpl\_error\_code} \\
        General description: & Resample the IFU exposures with rectangular pixels onto a square grid \\
        Mathematical description: & See section \ref{sssec:ifu_sci_postprocess} \\
        Quality assessment: & Through QC parameters \\
        Error conditions: & See~\cite{DRLVT}. \\
        Unit tests: & See~\cite{DRLVT}. \\
    \end{recipedef}

\subsubsection{IFU multi-exposure co-add}\label{drl:ifu_coadd}
    \begin{recipedef}
        Name: & \DRL{ifu_coadd} \\
        Purpose: & Co-add and dither individual subpixel-shifted exposures \\
        Used in recipes: & \REC{metis_ifu_postprocess}\\
        %Working remarks: & None \\
        %Function Parameters: & None \\
        Input: & $6\times$ \texttt{const hdrl\_image * input} \\
        %Other inputs: & precise position and orientation of individual exposures \\
        %QC outputs: & None\\
        %Output FITS files: & None \\
        Outputs:    & \PROD{IFU_SCI_COADD} \\
%                    & \PROD{IFU_SCI_COADD_ERROR} \\
                    & \texttt{cpl\_error\_code} \\
        General description: & Co-add the properly aligned IFU exposures \\
        Mathematical description: & See section \ref{sssec:ifu_sci_postprocess} \\
        Quality assessment: & Through QC parameters \\
        Error conditions: & See~\cite{DRLVT}. \\
        Unit tests: & See~\cite{DRLVT}. \\
    \end{recipedef}
